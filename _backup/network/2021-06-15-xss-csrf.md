---
title: "XSS vs CSRF"
excerpt: "비슷하면서도 다른 두 공격 기법에 대해 알아보자."
categories:
  - Network
tags:
  - Network
date: 2021-06-15
last_modified_at: 2021-06-15
---

## 1. XSS(Cross-Site Scripting)

사이트 간 스크립팅이란 웹 사이트 관리자가 아닌 제 3자가 웹 페이지에 악성 스크립트를 삽입하는 기법을 의미한다.

* 웹 애플리케이션이 사용자로부터 입력 받은 값을 제대로 검사하지 않고 사용할 경우 나타난다.
* 공격에 성공하면 사이트에 접속한 선량한 클라이언트는 자의와 상관없이 삽입된 코드를 실행하게 된다.
  * 보통 의도치 않은 행동을 수행시키거나 쿠키나 세션 토큰 등의 민감한 정보를 탈취한다.

### 1.1. 시나리오

![image](https://user-images.githubusercontent.com/56240505/122170267-5711fb80-ceb9-11eb-87c3-083e4e5976e0.png)

1. 해커는 웹 사이트 양식 중 하나(일반적으로 Javascript)를 사용하여 악성 스크립트를 웹 사이트 데이터베이스에 삽입한다.
2. 피해자는 웹 사이트에서 페이지를 요청한다.
3. 웹 사이트에는 DB의 악성 스크립트가 응답에 포함되어 피해자에게 전송된다.
4. 피해자의 브라우저는 Response 내에서 악성 스크립트를 실행하여, 피해자의 쿠키나 세션 등 민감 정보를 해커의 서버로 보낸다.

### 1.2. 간단한 대응 방식

* HTTP-only 속성은 클라이언트의 스크립트가 쿠키에 액세스할 수 있는지 여부를 지정한다.
* 해당 속성이 설정되어 있으면 스크립트로 쿠키에 접근할 수 없어, 공격자가 탈취할 수 없게 된다.
* 중요 정보는 쿠키에 저장하지 않는다.

<br>

## 2. CSRF(Cross-Site Request Forgery)

사이트 간 요청 위조는 선량한 클라이언트가 자신의 의지와는 무관하게 공격자가 의도한 행위(수정, 삭제, 등록 등)를 특정 웹사이트에 요청하게 하는 공격이다.

### 2.1. XSS와의 차이점

* XSS는 클라이언트가 특정 웹사이트를 신용하는 점을 노린다.
* CSRF는 특정 웹사이트가 클라이언트의 웹 브라우저를 신용하는 상태를 노린 것이다.

### 2.2. 시나리오

![image](https://user-images.githubusercontent.com/56240505/122171743-04d1da00-cebb-11eb-9eb8-2f79116880e2.png)

1. 클라이언트는 웹 사이트에 로그인한 상태(토큰이나 세션 등을 발급 받음)에서 사이트간 요청 위조 공격 코드가 삽입된 페이지를 연다.
2. 공격 대상이 되는 웹 사이트는 위조된 공격 명령이 믿을 수 있는 클라이언트로부터 발송된 것으로 판단하게 되어 공격에 노출된다.
3. 클라이언트의 권한 수준에 따라 피해 범위가 달라진다.

### 2.3. 전제조건

1. 위조 요청을 전송하는 서비스에 희생자가 로그인한 상태여야 한다.
2. 희생자는 공격자가 만든 피싱 사이트에 접속해야 한다.

### 2.4. 간단한 대응 방식

* 중요 정보는 쿠키에 저장하지 않는다.
* XSS 취약점을 확인한다.
* referer를 확인한다.
  * CORS : HTTP 요청의 Origin(출처)이 서버 리소스 Origin에 접근 가능한 referer인지 확인한다.
* 단순한 Session Token만 이용하여 권한을 부여하는 것을 금지한다.
* CSRF 토큰을 사용한다.

<br>

## 3. 정리

* XSS와 CSRF 모두 클라이언트의 브라우저를 목표로 하는 공격이다.
* XSS는 사이트 변조나 백도어를 통해 클라이언트에 대해 악성 공격을 수행한다.
  * 인증된 세션이 없어도 Javascript 실행을 통해 공격할 수 있다.
* CSRF는 요청을 위조하여 클라이언트의 권한을 이용해 서버에 대한 악성 공격을 수행한다.
  * 인증된 세션을 악용하며 특정 행동을 실행시키는 공격이라는 점에서 XSS와 차이가 있다.

<br>

---

## References

* [XSS와 CSRF 특징 및 차이](https://lucete1230-cyberpolice.tistory.com/23)
* [[Web 진단] XSS 공격 시나리오 & 진단방법](https://yprefer.tistory.com/23)
* [XSS와 CSRF(XSRF)의 차이점](https://program-developer.tistory.com/99)
